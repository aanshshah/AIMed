## SLURM PROLOG ###############################################################
##    Job ID : 2873747
##  Job Name : NeuralNetTrain
##  Nodelist : node417
##      CPUs : 4
##  Mem/Node : 40960 MB
## Directory : /gpfs/scratch/ashah3/AIMed/models
##   Started : Thu Feb 28 00:26:49 EST 2019
###############################################################################
module: loading 'anaconda/3-5.2.0'
module: unloading 'anaconda/3-5.2.0'
module: loading 'cuda/10.0.130'
module: loading 'cudnn/7.4'
module: cudnn: To use: module load cuda/10.0.130
Using TensorFlow backend.
sklearn.externals.joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/externals/joblib/externals/loky/process_executor.py", line 418, in _process_worker
    r = call_item()
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/externals/joblib/externals/loky/process_executor.py", line 272, in __call__
    return self.fn(*self.args, **self.kwargs)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/externals/joblib/_parallel_backends.py", line 567, in __call__
    return self.func(*args, **kwargs)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/externals/joblib/parallel.py", line 225, in __call__
    for func, args, kwargs in self.items]
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/externals/joblib/parallel.py", line 225, in <listcomp>
    for func, args, kwargs in self.items]
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/model_selection/_validation.py", line 528, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/pipeline.py", line 267, in fit
    self._final_estimator.fit(Xt, y, **fit_params)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/keras/wrappers/scikit_learn.py", line 210, in fit
    return super(KerasClassifier, self).fit(x, y, **kwargs)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/keras/wrappers/scikit_learn.py", line 141, in fit
    self.model = self.build_fn(**self.filter_sk_params(self.build_fn))
  File "neuralnet_fit.py", line 49, in create_model
    model = Sequential()
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/keras/engine/sequential.py", line 87, in __init__
    super(Sequential, self).__init__(name=name)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/keras/engine/network.py", line 96, in __init__
    self._init_subclassed_network(**kwargs)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/keras/engine/network.py", line 294, in _init_subclassed_network
    self._base_init(name=name)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/keras/engine/network.py", line 109, in _base_init
    name = prefix + '_' + str(K.get_uid(prefix))
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 74, in get_uid
    graph = tf.get_default_graph()
AttributeError: module 'tensorflow' has no attribute 'get_default_graph'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "neuralnet_fit.py", line 94, in <module>
    run_pipeline()
  File "neuralnet_fit.py", line 88, in run_pipeline
    grid.fit(x_train, y_train)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/model_selection/_search.py", line 722, in fit
    self._run_search(evaluate_candidates)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/model_selection/_search.py", line 1191, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/model_selection/_search.py", line 711, in evaluate_candidates
    cv.split(X, y, groups)))
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/externals/joblib/parallel.py", line 930, in __call__
    self.retrieve()
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/externals/joblib/parallel.py", line 833, in retrieve
    self._output.extend(job.get(timeout=self.timeout))
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/site-packages/sklearn/externals/joblib/_parallel_backends.py", line 521, in wrap_future_result
    return future.result(timeout=timeout)
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/gpfs/data/data2040/tf2-gpu/lib/python3.6/concurrent/futures/_base.py", line 384, in __get_result
    raise self._exception
AttributeError: module 'tensorflow' has no attribute 'get_default_graph'
